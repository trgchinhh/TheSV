<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Tra c·ª©u th·∫ª sinh vi√™n STU</title>
  <style>
    body { font-family: Arial, Helvetica, sans-serif; background:#f4f6f8; padding:20px; }
    h1 { text-align:center; margin-bottom:4px; }

    /* ƒê·∫©y ch·ªØ STU x√≠ch l√™n tr√™n */
    .stu { margin-top:-12px; margin-bottom:4px; text-align:center; }

    /* STU colors: S + U xanh d∆∞∆°ng, T ƒë·ªè */
    .stu span.s { color:#0a4fa3; }
    .stu span.t { color:#c40000; }
    .stu span.u { color:#0a4fa3; }

    .search { text-align:center; margin-bottom:20px; }
    input { padding:8px; width:220px; }
    button { padding:8px 16px; cursor:pointer; }

    .card-wrapper { display:flex; gap:30px; justify-content:center; margin-top:30px; }
    .card { width:320px; background:#fff; border:1px solid #ccc; border-radius:8px; padding:12px; }

    /* ===== M·∫∂T TR∆Ø·ªöC ===== */
    .front h3 { text-align:center; color:#0a4fa3; margin:0 0 8px; }
    .front h4 { text-align:center; color:#0a4fa3; margin:0 0 8px; }

	.photo {
		width:115px;
		height:150px;
		border:2px solid #0a4fa3;   /* xanh d∆∞∆°ng + d√†y */
		border-radius:0px;          /* bo nh·∫π cho gi·ªëng th·∫ª th·∫≠t */
		margin:10px auto;
		display:flex;
		align-items:center;
		justify-content:center;
	}

    .name { color:#c40000; font-weight:bold; text-align:center; margin:6px 0; }

    .info { font-size:14px; line-height:1.6; color:#0a4fa3; text-align:center; }
    .info .mssv { font-weight:bold; }

    .school-box {
      margin-top:10px; background:#0a4fa3; color:#fff;
      text-align:center; font-size:12px; padding:6px; border-radius:4px;
    }
    .school-name {
        text-align: center;
        color: #0a4fa3;
        font-weight: bold;      /* in ƒë·∫≠m */
        font-size: 15px;        /* gi·ªØ g·ªçn 1 d√≤ng */
        white-space: nowrap;    /* √âP 1 D√íNG */
    }


    /* ===== M·∫∂T SAU ===== */
    .back h3 {
      text-align:center; color:#c40000;
      font-size:22px; font-weight:bold;
      margin-bottom:2px;
    }

    .course {
      text-align:center;
      color:#c40000;
      font-weight:bold;
      margin-top:0;
      margin-bottom:12px;
    }

    .rule {
      font-size:14px;
      margin-bottom:10px;
      color:#0a4fa3;
      font-weight:bold;
    }

    .qr {
        width:160px;
        height:160px;
        /* border:1px solid #000; */
        border: none;
		margin:30px auto 0;
        display:flex;
        align-items:center;
        justify-content:center;
        overflow:hidden; /* QUAN TR·ªåNG */
    }

        /* QUAN TR·ªåNG */
    .qr {
      width:160px;
      height:160px;
      margin:30px auto 0;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .qr canvas {
      width:160px !important;
      height:160px !important;
    }

    .hidden { display:none; }

    /* ===== RESPONSIVE CHO ƒêI·ªÜN THO·∫†I ===== */
    @media (max-width: 768px) {
      .card-wrapper {
        flex-direction: column;   /* üëà x·∫øp D·ªåC */
        align-items: center;
      }

      .card {
        width: 100%;              /* full chi·ªÅu ngang */
        max-width: 340px;         /* gi·ªØ form th·∫ª ƒë·∫πp */
      }
    }

  </style>
</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<body>
  <h1>Tra c·ª©u th·∫ª sinh vi√™n</h1>

  <div class="search">
    <input id="mssvInput" placeholder="Nh·∫≠p MSSV" />
    <button onclick="lookup()">Tra c·ª©u</button>
  </div>

  <div id="result" class="card-wrapper hidden">
    <!-- ===== M·∫∂T TR∆Ø·ªöC ===== -->
    <div class="card front">
      <h1 class="stu">
        <span class="s">S</span><span class="t">T</span><span class="u">U</span>
      </h1>
      <h3 class="school-name">TR∆Ø·ªúNG ƒê·∫†I H·ªåC C√îNG NGH·ªÜ S√ÄI G√íN</h3>

      <div class="photo">
        <img id="photo" src="" alt="·∫¢nh sinh vi√™n" style="width:100%; height:100%; object-fit:cover;">
      </div>


      <div class="name" id="name"></div>

      <div class="info">
        Ng√†y sinh: <span id="dob"></span><br/>
        L·ªõp: <span id="class"></span><br/>
        <span id="major"></span><br/>
        <strong>MSSV:</strong> <span id="mssv" class="mssv"></span>
      </div>

      <div class="school-box">
        180 Cao L·ªó, Ph∆∞·ªùng 4, Qu·∫≠n 8, TP.H·ªì Ch√≠ Minh<br>
		ƒêi·ªán Tho·∫°i: 028.38505520 * Fax: 028.38506595
      </div>
    </div>

    <!-- ===== M·∫∂T SAU ===== -->
    <div class="card back">
      <h3>TH·∫∫ SINH VI√äN</h3>
      <div class="course">Kh√≥a h·ªçc 2024 - 2028</div>

      <div class="rule">1. Th·∫ª sinh vi√™n c√≥ gi√° tr·ªã trong th·ªùi gian ƒë√†o t·∫°o t·∫°i tr∆∞·ªùng. H·∫øt th·ªùi h·∫°n ghi tr√™n th·∫ª, th·∫ª sinh vi√™n kh√¥ng c√≤n gi√° tr·ªã.</div>
      <div class="rule">2. Th·∫ª sinh vi√™n ƒë·ªìng th·ªùi l√† th·∫ª d·ª± thi trong qu√° tr√¨nh h·ªçc t·∫≠p t·∫°i tr∆∞·ªùng.</div>

      <div class="qr" id="qr"></div>


    </div>
  </div>

<script>
  function removeVietnameseTones(str) {
    return str
      .normalize("NFD")
      .replace(/[\u0300-\u036f]/g, "")
      .replace(/ƒë/g, "d")
      .replace(/ƒê/g, "D")
      .replace(/\s+/g, "")
      .toUpperCase();
  }

  function lookup() {
    const mssv = document.getElementById("mssvInput").value.trim().toUpperCase();
    const result = document.getElementById("result");
    const qrBox = document.getElementById("qr");

    if (!mssv) {
      alert("Vui l√≤ng nh·∫≠p MSSV");
      return;
    }

    const basePath = `data/${mssv}`;

    fetch(`${basePath}/data.json`)
      .then(res => {
        if (!res.ok) throw new Error();
        return res.json();
      })
      .then(sv => {
        document.getElementById("name").innerText = sv.name;
        document.getElementById("dob").innerText = sv.dob;
        document.getElementById("class").innerText = sv.class;
        document.getElementById("major").innerText = sv.major;
        document.getElementById("mssv").innerText = sv.mssv;

        // ·∫¢nh sinh vi√™n = MSSV.png
        document.getElementById("photo").src = `${basePath}/photo.png`;

        // ===== T·∫†O N·ªòI DUNG QR =====
        const nameNoAccent = removeVietnameseTones(sv.name);
        const dobQR = sv.dob.replace(/\//g, ".");
        const qrContent = `${sv.mssv}_${nameNoAccent}_${dobQR}`;

        // Xo√° QR c≈©
        qrBox.innerHTML = "";

        // T·∫°o QR m·ªõi
        new QRCode(qrBox, {
          text: qrContent,
          width: 160,
          height: 160,
          correctLevel: QRCode.CorrectLevel.H
        });

        result.classList.remove("hidden");
      })
      .catch(() => {
        alert("Kh√¥ng t√¨m th·∫•y sinh vi√™n");
        result.classList.add("hidden");
      });
  }
</script>

</body>
</html> 